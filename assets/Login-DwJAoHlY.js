import{d as $,r as v,c as x,w as C,a as g,b as t,e as T,t as _,f as E,T as U,g as I,v as j,h as A,n as B,u as P,i as D,j as O,k as q,o as f,l as z,m as G,F,p as H,_ as Z}from"./index-DHeZEGD7.js";const J="some_token",S="https://api.some-domain.com",K=()=>({Authorization:"Bearer "+J});async function N(m,o,i){const s=K(),c=new Request(o,{method:m,headers:{...s,"Content-Type":"application/json"},body:i?JSON.stringify(i):null});console.log(c);let a;try{const d=Math.round(Math.random()*4),h=d<4?200:500,p=new Blob,w=new Response(p,{status:h});w.json=()=>Promise.resolve({success:d<4}),a=await Promise.resolve(w)}catch(d){console.error(`${m} data error:`,d),a=null}if(!a)return{ok:!1};const l=await a.json().catch(d=>{console.error("couldn't parse to json",a,d)});return{ok:a.ok,body:l,headers:a.headers,status:a.status}}const W={getData:m=>N("GET",m,null),postData:(m,o)=>N("POST",m,o)},R={signUp:()=>`${S}/sign-up`,signIn:()=>`${S}/sign-in`},Y="/login-simple/assets/eye-opened-Cxh0Mfpp.png",Q="/login-simple/assets/eye-closed-CEvhtM-_.png",X={class:"login-view"},ee={class:"create-user"},se={key:0,class:"header"},ae={class:"server-error-message"},te={key:0,src:"https://static.vecteezy.com/system/resources/thumbnails/012/042/292/small_2x/warning-sign-icon-transparent-background-free-png.png",alt:"caution",width:"20px",height:"20px"},oe={key:1,class:"header"},le={class:"form-wrapper"},ne={id:"login-form",class:"form"},re=["aria-invalid"],ue={class:"password-wrapper"},ie=["autocomplete","type","aria-invalid"],ce=["src","alt"],de=["disabled"],ve={class:"validation-message-wrapper"},pe={class:"validation-messages"},me=$({__name:"Login",setup(m){const o=v(!1),i=v(""),s=v(""),c=v(!1),a=v(!1),l=v(""),d=v(!1),h=v(!1),p=v(!1),w=x(()=>{if(!o.value||s.value.length===0)return[];const n=[];n.push(s.value.length<10?"Password must be at least 10 characters long":""),n.push(s.value.length>24?"Password must be at most 24 characters long":""),n.push(s.value.includes(" ")?"Password cannot contain spaces":""),n.push(s.value.match(/\d+/g)===null?"Password must contain at least one number":""),n.push(s.value.toLowerCase()===s.value?"Password must contain at least one uppercase letter":""),n.push(s.value.toUpperCase()===s.value?"Password must contain at least one lowercase letter":"");const e=[];for(const r of n)r&&e.push(r);return e}),y=x(()=>{const n=i.value.length>0&&i.value.match(/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/);return o?s.value.length>0&&w.value.length===0&&n:s.value.length>0&&n});async function L(n){if(n.preventDefault(),h.value||!y.value)return;const e=o.value;c.value=!1,h.value=!0;const r={email:i.value,password:s.value},b=e?R.signUp():R.signIn(),u=await W.postData(b,r);if(console.log(u),h.value=!1,!u.ok)!u.status||u.status===500?(l.value="Something went wrong, please try again.",c.value=!0,a.value=!0):u.status===401||u.status===403?l.value="Not authenticated to access this resource.":u.status===422&&u.body?.errors?.includes("wrong_credentials")?(l.value="Sorry, the entered credentials are incorrect, please try again.",c.value=!0,a.value=!0):u.status===422&&u.body?.errors?(l.value=`Your password has the following issues: ${u.body.errors.map(k=>k.replace("_"," ")).join(", ")}`,a.value=!0):(l.value="Something went wrong, please try again.",c.value=!0,a.value=!0);else{const k=e?1e3:10,V=e?"New user successfully created.":"";setTimeout(()=>q.push("/main"),k),d.value=!0,l.value=V}}function M(){o.value=!o.value,l.value="",i.value="",s.value="",c.value=!1,a.value=!1,h.value=!1}return C(s,()=>{a.value===!0&&(a.value=!1),l.value=""}),C(i,()=>{c.value===!0&&(c.value=!1),l.value=""}),(n,e)=>(f(),g("div",X,[t("div",ee,[t("button",{type:"button",class:"submit-button",onClick:M},_(o.value?"LOGIN":"CREATE USER"),1)]),T(U,{mode:"out-in"},{default:E(()=>[l.value?(f(),g("div",se,[t("p",ae,[d.value?z("",!0):(f(),g("img",te)),G(" "+_(l.value),1)])])):(f(),g("div",oe,[t("h1",null,_(o.value?"REGISTRATION":"LOGIN"),1),e[3]||(e[3]=t("h4",null,"Please enter your email and password",-1))]))]),_:1}),t("div",le,[t("form",ne,[e[4]||(e[4]=t("label",{for:"email"},"Email",-1)),I(t("input",{"onUpdate:modelValue":e[0]||(e[0]=r=>i.value=r),autocomplete:"on",required:"",id:"email",type:"email",placeholder:"john@example.com","aria-invalid":c.value},null,8,re),[[j,i.value]]),e[5]||(e[5]=t("label",{for:"password"},"Password",-1)),t("div",ue,[I(t("input",{"onUpdate:modelValue":e[1]||(e[1]=r=>s.value=r),autocomplete:`${o.value?"new":"current"}-password`,required:"",type:p.value?"text":"password",id:"password","aria-invalid":a.value},null,8,ie),[[A,s.value]]),t("img",{src:p.value?P(Q):P(Y),alt:`${p.value?"hide":"show"}-password`,width:"25px",height:"15px",class:"show-password",style:B({opacity:p.value?"0.4":"1"}),onClick:e[2]||(e[2]=r=>p.value=!p.value)},null,12,ce)]),t("button",{type:"button",class:D(["submit-button",{loading:h.value,disabled:!y.value}]),disabled:!y.value,onClick:L},_(o.value?"Register":"Log In"),11,de)])]),t("div",ve,[t("ul",pe,[T(O,{name:"list"},{default:E(()=>[(f(!0),g(F,null,H(w.value,(r,b)=>(f(),g("li",{key:`validation-${b}`,class:"validation-item"},_(r),1))),128))]),_:1})])])]))}}),ge=Z(me,[["__scopeId","data-v-97479684"]]);export{ge as default};
